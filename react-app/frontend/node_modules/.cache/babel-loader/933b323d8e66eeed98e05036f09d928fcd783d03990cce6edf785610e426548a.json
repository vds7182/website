{"ast":null,"code":"import React,{useEffect,useState}from'react';import{getAuth,onAuthStateChanged}from'firebase/auth';import{auth}from'./backend/firebase-db';// Файл должен находиться в src/backend/firebase-db.js\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function UserApplication(){const[user,setUser]=useState(null);const[applications,setApplications]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const unsub=onAuthStateChanged(auth,currentUser=>{setUser(currentUser);if(currentUser){fetchUserData(currentUser.uid);fetchApplications(currentUser.uid);}});return()=>unsub();},[]);// Запрос данных пользователя (по-прежнему для отладки)\nconst fetchUserData=async userId=>{try{const res=await fetch(`http://localhost:5000/user/${userId}`);const data=await res.json();console.log('User Data:',data);}catch(err){console.error('Error fetching user data:',err);}};// Запрос заявок пользователя\nconst fetchApplications=async userId=>{try{const res=await fetch(`http://localhost:5000/applications/${userId}`);const data=await res.json();setApplications(data);}catch(err){console.error('Error fetching applications:',err);}finally{setLoading(false);}};// Отправка заявки\nconst createApplication=async applicationData=>{if(!user)return;try{// Здесь можно отправлять заявку в формате, где есть и объект вакансии, а не только ключ:\n// Пример: { vacancy: { title: 'Разработчик', description: 'Frontend-разработка' }, appliedAt: new Date() }\nconst res=await fetch(`http://localhost:5000/applications/${user.uid}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(applicationData)});const data=await res.json();console.log('Application Response:',data);}catch(err){console.error('Error creating application:',err);}};// Создание пользователя\nconst createUser=async userData=>{if(!user)return;try{const res=await fetch(`http://localhost:5000/user/${user.uid}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(userData)});const data=await res.json();console.log('User Response:',data);}catch(err){console.error('Error creating user:',err);}};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041F\\u043E\\u0434\\u0430\\u043D\\u0456 \\u0437\\u0430\\u044F\\u0432\\u043A\\u0438\"}),applications.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423 \\u0432\\u0430\\u0441 \\u0449\\u0435 \\u043D\\u0435\\u043C\\u0430\\u0454 \\u043F\\u043E\\u0434\\u0430\\u043D\\u0438\\u0445 \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A.\"}):/*#__PURE__*/_jsx(\"ul\",{children:applications.map(app=>{var _app$appliedAt,_app$appliedAt$toDate;return/*#__PURE__*/_jsxs(\"li\",{children:[app.vacancy?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u043D\\u0430 \\u0432\\u0430\\u043A\\u0430\\u043D\\u0441\\u0456\\u044E:\"}),\" \",app.vacancy.title,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"em\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435:\"}),\" \",app.vacancy.description]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u043D\\u0430 \\u0432\\u0430\\u043A\\u0430\\u043D\\u0441\\u0456\\u044E: \",app.vacancyId]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041F\\u043E\\u0434\\u0430\\u043D\\u043E: \"}),((_app$appliedAt=app.appliedAt)===null||_app$appliedAt===void 0?void 0:(_app$appliedAt$toDate=_app$appliedAt.toDate)===null||_app$appliedAt$toDate===void 0?void 0:_app$appliedAt$toDate.call(_app$appliedAt).toLocaleString())||'—']},app.id);})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>createUser({name:'Иван',experience:'2 years'}),children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>createApplication({vacancy:{title:'Разработчик',description:'Frontend-разработка'},appliedAt:new Date()}),children:\"\\u041F\\u043E\\u0434\\u0430\\u0442\\u044C \\u0437\\u0430\\u044F\\u0432\\u043A\\u0443\"})]});}export default UserApplication;","map":{"version":3,"names":["React","useEffect","useState","getAuth","onAuthStateChanged","auth","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","UserApplication","user","setUser","applications","setApplications","loading","setLoading","unsub","currentUser","fetchUserData","uid","fetchApplications","userId","res","fetch","data","json","console","log","err","error","createApplication","applicationData","method","headers","body","JSON","stringify","createUser","userData","children","length","map","app","_app$appliedAt","_app$appliedAt$toDate","vacancy","title","description","vacancyId","appliedAt","toDate","call","toLocaleString","id","onClick","name","experience","Date"],"sources":["/Users/mihailmirosnicenko/Documents/html/lab-web/lab5/react-app/frontend/src/UserApplication.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport { auth } from './backend/firebase-db'; // Файл должен находиться в src/backend/firebase-db.js\n\nfunction UserApplication() {\n  const [user, setUser] = useState(null);\n  const [applications, setApplications] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsub = onAuthStateChanged(auth, (currentUser) => {\n      setUser(currentUser);\n      if (currentUser) {\n        fetchUserData(currentUser.uid);\n        fetchApplications(currentUser.uid);\n      }\n    });\n    return () => unsub();\n  }, []);\n\n  // Запрос данных пользователя (по-прежнему для отладки)\n  const fetchUserData = async (userId) => {\n    try {\n      const res = await fetch(`http://localhost:5000/user/${userId}`);\n      const data = await res.json();\n      console.log('User Data:', data);\n    } catch (err) {\n      console.error('Error fetching user data:', err);\n    }\n  };\n\n  // Запрос заявок пользователя\n  const fetchApplications = async (userId) => {\n    try {\n      const res = await fetch(`http://localhost:5000/applications/${userId}`);\n      const data = await res.json();\n      setApplications(data);\n    } catch (err) {\n      console.error('Error fetching applications:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Отправка заявки\n  const createApplication = async (applicationData) => {\n    if (!user) return;\n    try {\n      // Здесь можно отправлять заявку в формате, где есть и объект вакансии, а не только ключ:\n      // Пример: { vacancy: { title: 'Разработчик', description: 'Frontend-разработка' }, appliedAt: new Date() }\n      const res = await fetch(`http://localhost:5000/applications/${user.uid}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(applicationData),\n      });\n      const data = await res.json();\n      console.log('Application Response:', data);\n    } catch (err) {\n      console.error('Error creating application:', err);\n    }\n  };\n\n  // Создание пользователя\n  const createUser = async (userData) => {\n    if (!user) return;\n    try {\n      const res = await fetch(`http://localhost:5000/user/${user.uid}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(userData),\n      });\n      const data = await res.json();\n      console.log('User Response:', data);\n    } catch (err) {\n      console.error('Error creating user:', err);\n    }\n  };\n\n  if (loading) return <p>Завантаження...</p>;\n\n  return (\n    <div>\n      <h2>Подані заявки</h2>\n      {applications.length === 0 ? (\n        <p>У вас ще немає поданих заявок.</p>\n      ) : (\n        <ul>\n          {applications.map((app) => (\n            <li key={app.id}>\n              {app.vacancy ? (\n                <>\n                  <strong>Заявка на вакансію:</strong> {app.vacancy.title}\n                  <br />\n                  <em>Описание:</em> {app.vacancy.description}\n                </>\n              ) : (\n                <>Заявка на вакансію: {app.vacancyId}</>\n              )}\n              <br />\n              <strong>Подано: </strong>\n              {app.appliedAt?.toDate?.().toLocaleString() || '—'}\n            </li>\n          ))}\n        </ul>\n      )}\n      {/* Кнопки для создания пользователя и заявки */}\n      <button onClick={() => createUser({ name: 'Иван', experience: '2 years' })}>\n        Создать пользователя\n      </button>\n      <button\n        onClick={() =>\n          createApplication({\n            vacancy: { title: 'Разработчик', description: 'Frontend-разработка' },\n            appliedAt: new Date(),\n          })\n        }\n      >\n        Подать заявку\n      </button>\n    </div>\n  );\n}\n\nexport default UserApplication;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}